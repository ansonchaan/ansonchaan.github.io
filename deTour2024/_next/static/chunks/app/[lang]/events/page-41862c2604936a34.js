(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[702],{8425:function(e,t,a){Promise.resolve().then(a.bind(a,6718)),Promise.resolve().then(a.bind(a,3297)),Promise.resolve().then(a.bind(a,824)),Promise.resolve().then(a.t.bind(a,4080,23)),Promise.resolve().then(a.bind(a,7045)),Promise.resolve().then(a.bind(a,1640)),Promise.resolve().then(a.bind(a,9637)),Promise.resolve().then(a.bind(a,6061)),Promise.resolve().then(a.bind(a,5417))},1640:function(e,t,a){"use strict";a.d(t,{default:function(){return j}});var l=a(7437),s=a(5721),r=a(30),n=a(8116),i=a(8349),c=a(2265),d=e=>{let{className:t,year:a=new Date().getFullYear(),onDateSelect:s,selectedDate:d,enabledDates:o=[],lang:u}=e,[g,m]=(0,c.useState)(d||null),[p,h]=(0,c.useState)([]),[x,f]=(0,c.useState)([]);(0,c.useEffect)(()=>{let e=new Date(a,10,25),t=new Date(a,11,15),l=(0,n.Z)({start:e,end:t});h(l);let s=l[0],r=s?(s.getDay()+6)%7:0,i=l[l.length-1],c=i?(7-((i.getDay()+6)%7+1))%7:0,d=[...Array(r).fill(null),...l,...Array(c).fill(null)],o=[];for(let e=0;e<d.length;e+=7)o.push(d.slice(e,e+7));f(o)},[a]);let b=e=>!!e&&o.some(t=>e.getDate()===t.getDate()&&e.getMonth()===t.getMonth()&&e.getFullYear()===t.getFullYear()),y=e=>{m(e),null==s||s(e)};(0,c.useEffect)(()=>{null==m||m(null!=d?d:null)},[d]);let v=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],j=new Date,k=e=>{let t=g&&(0,i.Z)(e,"yyyy-MM-dd")===(0,i.Z)(g,"yyyy-MM-dd"),a=(0,i.Z)(e,"yyyy-MM-dd")===(0,i.Z)(j,"yyyy-MM-dd"),l=b(e);return"".concat(t?"selected":""," ").concat(a?"today":""," ").concat(l?"":"disabled")};return(0,l.jsx)("div",{className:t,children:(0,l.jsxs)("div",{className:"flex flex-col",children:[(0,l.jsx)("div",{className:"h-12 grid grid-cols-7 text-[#B6B7B2] text-sm font-medium justify-center items-center border-b border-[#B6B7B2]/20",children:("en-us"===u?["M","T","W","T","F","S","S"]:["一","二","三","四","五","六","日"]).map((e,t)=>(0,l.jsx)("div",{className:"flex-1 text-center",children:e},"week-".concat(e,"-").concat(t)))}),(0,l.jsx)("div",{className:(0,r.Z)("text-center text-lg","[&>.calendar-row]:border-b [&>.calendar-row]:border-[#B6B7B2]/20","[&_.day]:flex [&_.day]:flex-col [&_.day]:justify-end [&_.day]:items-center [&_.day]:py-3 [&_.day:not(.disabled)]:cursor-pointer [&_.day:not(.disabled):hover_.day-num]:bg-lightGray [&_.day:not(.disabled):hover_.day-num]:text-purple","[&_.selected_.day-num]:bg-lightGray [&_.selected_.day-num]:text-purple [&_.day-num]:transition-colors","[&_.disabled_.day-num]:opacity-30"),children:x.map((e,t)=>(0,l.jsx)("div",{className:"calendar-row grid grid-cols-7 gap-3 px-3",children:e.map((e,a)=>(0,l.jsxs)("div",{className:(0,r.Z)("day ",e&&k(e)),onClick:()=>e&&b(e)&&y(e),children:[((null==e?void 0:e.getDate())===25||(null==e?void 0:e.getDate())===1)&&(0,l.jsx)("span",{className:"month h-3 mb-1 text-xxs uppercase flex justify-center items-center",children:e&&"en-us"===u?v[e.getMonth()]:"".concat(e.getMonth()+1,"月")}),(0,l.jsx)("span",{className:"day-num w-[3.125rem] h-[2.25rem] rounded-[1.25rem] flex justify-center items-center",children:null==e?void 0:e.getDate()})]},"row-".concat(t,"-cell-").concat(a)))},"row-".concat(t)))})]})})},o=a(9413),u=a(9533),g=a(3835),m=a(3297),p=a(6718),h=a(9935),x=a(4446),f=a(6463);function b(e){let{post:t,formatDate:a,formatTime:s,selectedDate:n,text:i,lang:d}=e,o=(0,c.useMemo)(()=>{if(n){let e=t.data.slices2.flatMap(e=>e.primary.dates.flatMap(e=>new Date(e.available_from)>=n?e:[]));return"guided-tour"===t.data.category.uid?e.slice(0,3):e}let e=t.data.slices2.flatMap(e=>e.primary.dates.flatMap(e=>e));return"guided-tour"===t.data.category.uid?e.slice(0,3):e},[n,t.data.category.uid,t.data.slices2]),u=(0,c.useMemo)(()=>{if(t.data.slices3.length>0&&t.data.slices3[0].primary.speakers&&t.data.slices3[0].primary.speakers.length>0){let e=t.data.slices3[0].primary.speakers.map(e=>e.name);return[t.data.slices3[0].primary.name,...e].join("en-us"===d?", ":"、")}return""},[t.data.slices3,d]);return(0,l.jsxs)("li",{className:"flex gap-3 xl:gap-6 flex-col lg:flex-row",children:[(0,l.jsxs)(m.PrismicNextLink,{document:t,className:"flex-1 relative inline-block aspect-[448/300] w-full overflow-hidden",children:[(0,l.jsx)("div",{className:(0,r.Z)("absolute top-0 left-0 px-3 py-1 rounded-[1.3125rem]","workshop"===t.data.category.uid||"detour-kid"===t.data.category.uid?"text-black":"text-white","workshop"===t.data.category.uid||"detour-kid"===t.data.category.uid?"bg-lightGray":"creative-voice"===t.data.category.uid?"bg-purple":"bg-gray"),children:t.data.category.data.label}),(0,l.jsx)(p.PrismicNextImage,{className:"size-full object-cover rounded-[1.3125rem]",field:t.data.gallery[0].image,alt:"",width:600})]}),(0,l.jsxs)("div",{className:"flex-1",children:[(0,l.jsxs)(m.PrismicNextLink,{document:t,children:[(0,l.jsx)("h1",{className:(0,r.Z)("text-lg","en-us"===d?"leading-6":"leading-[1,7rem]"),children:t.data.title}),(0,l.jsx)("div",{className:(0,r.Z)("text-lg opacity-50","en-us"===d?"leading-6":"leading-[1.7rem]"),children:"workshop"===t.data.category.uid||"detour-kid"===t.data.category.uid?t.data.slices3.length>0?t.data.slices3[0].primary.name:"":"creative-voice"===t.data.category.uid?u:""})]}),(0,l.jsx)("div",{className:"flex flex-col mt-3",children:o.map(e=>(0,l.jsx)(m.PrismicNextLink,{document:e.booking_link,target:"_blank",className:(0,r.Z)(e.full_booking?"pointer-events-none opacity-25":"","px-4 py-[.3125rem] first:mt-0 mt-[-1px] rounded-full text-lg transition-all border","guided-tour"===t.data.category.uid?"[&:nth-child(2)]:opacity-50 [&:nth-child(3)]:opacity-30":"",void 0===n||(null==n?void 0:n.getDate())===new Date(e.available_from).getDate()&&(null==n?void 0:n.getMonth())===new Date(e.available_from).getMonth()?"opacity-100 border-black hover:bg-black hover:text-white":"border-transparent opacity-30"),children:(0,l.jsxs)("div",{className:"flex justify-between",children:[(0,l.jsxs)("div",{className:"flex gap-1",children:[(0,l.jsx)("div",{children:a(new Date(e.available_from))}),(0,l.jsx)("span",{children:"→"}),(0,l.jsx)("div",{children:"".concat(s(new Date(e.available_from)),"–").concat(s(new Date(e.available_to)))})]}),(0,l.jsx)("p",{children:e.full_booking?i.full:i.book})]})},e.available_from))}),"guided-tour"===t.data.category.uid&&(0,l.jsx)(m.PrismicNextLink,{document:t,className:"px-4 py-[.3125rem] text-lg opacity-20 inline-block",children:i.timeSlotsAvailable})]})]})}function y(e){let{selectedCategory:t,selectedDate:a,enableCalendar:s,navigation:n,handleCategoryChange:i,setSelectedDate:c,setEnableCalendar:d,text:o,lang:u}=e;return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)("div",{className:(0,r.Z)("flex gap-2 md:gap-3 flex-col p-4 py-3 md:p-5 bg-lightGray/90 rounded-[1.3125rem] text-lg md:*:text-xl","en-us"===u?"*:leading-6":"*:leading-[1.7rem]"),children:[(0,l.jsx)(v,{id:"allevents",label:o.allEvents,checked:0===t.length,onChange:()=>{t.length>0&&i(null)}}),n.data.categories.map(e=>(0,l.jsx)(v,{id:e.category.uid,label:e.category.data.label,checked:t.includes(e.category.uid),onChange:()=>i(e.category.uid)},e.category.uid))]}),(0,l.jsxs)("div",{className:(0,r.Z)("flex gap-2 md:gap-3 flex-col p-4 py-3 md:p-5 bg-gray/90 text-white rounded-[1.3125rem] text-lg md:*:text-xl","en-us"===u?"*:leading-6":"*:leading-[1.7rem]"),children:[(0,l.jsx)(v,{id:"alldates",label:o.allDates,checked:void 0===a&&!s,onChange:()=>{(void 0!==a||s)&&(c(void 0),d(!1))}}),(0,l.jsx)(v,{id:"selectdate",label:o.selectDate,checked:s,onChange:()=>{s?(c(void 0),d(!1)):d(!0)}})]})]})}function v(e){let{id:t,label:a,checked:s,onChange:n}=e;return(0,l.jsxs)("label",{htmlFor:t,className:"w-full flex justify-between cursor-pointer",children:[a,(0,l.jsx)("input",{className:"peer hidden",type:"checkbox",id:t,checked:s,onChange:n}),(0,l.jsx)("div",{className:(0,r.Z)("w-[2.8125rem] h-[1.5625rem] bg-[#B6B7B2] rounded-full relative transition-colors duration-300 ease-in-out","peer-checked:bg-purple peer-checked:before:translate-x-5 peer-checked:hover:before:translate-x-[1.125rem]","before:rounded-full before:w-[1.0625rem] before:h-[1.0625rem] before:bg-lightGray before:block before:absolute before:top-1/2 before:left-1 before:-translate-y-1/2 before:transition-transform before:duration-300 before:ease-checkboxEase","hover:before:translate-x-[.125rem]")})]})}function j(e){let{navigation:t,lang:a}=e,n=(0,f.useSearchParams)(),i=(0,f.useRouter)(),[m,p]=(0,c.useState)([]),[j,k]=(0,c.useState)(n.getAll("cat")),[N,w]=(0,c.useState)(void 0),[_,D]=(0,c.useState)(!1),[M,C]=(0,c.useState)([]),[S,E]=(0,c.useState)(!1),[B,P]=(0,c.useState)(!1),{width:Z}=(0,s.i)(),A=(0,c.useRef)(!1),F=u[a].common,T=(0,c.useCallback)(()=>{A.current||k(n.getAll("cat")),A.current=!1},[n]),z=(0,c.useCallback)(e=>{A.current=!0,e?(k(t=>t.includes(e)?t.filter(t=>t!==e):[...t,e]),i.push("?cat=".concat(e))):(k([]),i.push("/".concat(a,"/events")))},[i,a]),G=(0,c.useCallback)(e=>(null==j?void 0:j.length)?e.filter(e=>j.some(t=>e.data.category.uid===t)):e,[j]),J=(0,c.useCallback)(e=>N?e.filter(e=>e.data.slices2.some(e=>e.primary.dates.some(e=>new Date(e.available_from).getDate()===N.getDate()&&new Date(e.available_from).getMonth()+1===N.getMonth()+1))):e,[N]),L=(0,c.useCallback)(async()=>{D(!0);let e=(0,o.e)();try{let t=await e.getAllByType("events_post",{orderings:[{field:"my.events_post.publication_date",direction:"asc"},{field:"document.first_publication_date",direction:"asc"}],filters:[g.h.not("document.tags",["Exhibition"])],fetchLinks:["category.label"],lang:a}),l=G(t),s=J(l);p(s),C(l.flatMap(e=>e.data.slices2.flatMap(e=>e.primary.dates.map(e=>new Date(e.available_from)))))}catch(e){console.log(e)}finally{D(!1)}},[G,J,a]),O=(0,c.useCallback)(e=>{let t="en-us"===a?["Sun","Mon","Tue","Wed","Thu","Fri","Sat"]:["日","一","二","三","四","五","六"];return"en-us"===a?"".concat(e.getDate()," ").concat(["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"][e.getMonth()]," (").concat(t[e.getDay()],")"):"".concat(e.getMonth()+1,"月").concat(e.getDate(),"日(").concat(t[e.getDay()],")")},[a]),I=(0,c.useCallback)(e=>{let t=e.getHours(),a=e.getMinutes();return"".concat(t<10?"0".concat(t):t,":").concat(a<10?"0".concat(a):a)},[]);return(0,c.useEffect)(()=>{T()},[T]),(0,c.useEffect)(()=>{L()},[L]),(0,l.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3 xl:gap-6",children:[(0,l.jsxs)("div",{className:"block md:hidden mb-7",onClick:()=>{P(!0)},children:[(0,l.jsx)("div",{className:"flex flex-col gap-2 px-4 pt-3 pb-8 bg-lightGray/90 text-black text-lg rounded-[1.3125rem]",children:null!==j&&j.length>0?t.data.categories.map(e=>j.map(t=>e.category.uid===t&&(0,l.jsx)("div",{className:"flex justify-between",children:(0,l.jsx)(v,{id:"e",label:e.category.data.label,checked:!0,onChange:()=>{}})},e.category.uid))):(0,l.jsx)("div",{className:"flex justify-between",children:(0,l.jsx)(v,{id:"e",label:F.allEvents,checked:!0,onChange:()=>{}})})}),(0,l.jsx)("div",{className:(0,r.Z)("px-4 pt-3 pb-8 -mt-5 bg-gray text-white rounded-[1.3125rem] text-lg relative","after:size-5 after:bg-[url('../../public/assets/images/arrow-down.svg')] after:bg-no-repeat after:bg-center after:absolute after:left-1/2 after:bottom-2 after:-translate-x-1/2"),children:(0,l.jsx)(v,{id:"e",label:N?"".concat(F.selectDate,": ").concat(O(N)):F.allDates,checked:!0,onChange:()=>{}})})]}),(0,l.jsx)(h.E.div,{initial:{opacity:1},animate:{opacity:_?.3:1},className:(0,r.Z)("col-span-1 lg:col-span-2 relative",_?"opacity-30 pointer-events-none":"opacity-100"),children:(0,l.jsx)("ul",{className:"flex flex-col gap-16 xl:gap-6",children:m.length>0?m.map(e=>(0,l.jsx)(b,{post:e,formatDate:O,formatTime:I,selectedDate:N,text:F,lang:a},e.id)):(0,l.jsx)("p",{className:"text-lg",children:F.noEvents})})}),(0,l.jsx)(x.M,{children:(B||Z>767)&&(0,l.jsx)(h.E.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"w-[100vw] h-svh px-3 md:px-0 md:w-full md:h-auto fixed top-0 left-0 z-50 md:z-40 md:relative bg-[#B6B7B2]/80 md:bg-inherit backdrop-blur-md md:backdrop-blur-none",children:(0,l.jsxs)("div",{className:"flex gap-3 flex-col relative top-1/2 -translate-y-1/2 md:translate-y-0 md:sticky md:top-3 xl:top-6 z-40",children:[(0,l.jsx)(y,{selectedCategory:j,selectedDate:N,enableCalendar:S,navigation:t,handleCategoryChange:z,setSelectedCategory:k,setSelectedDate:w,setEnableCalendar:E,text:F,lang:a}),(0,l.jsx)(d,{className:(0,r.Z)("bg-gray/90 text-white rounded-[1.3125rem] overflow-hidden transition-opacity duration-[0.3s] ease-in-out",S?"":"opacity-20 pointer-events-none"),year:2024,onDateSelect:w,selectedDate:N||void 0,enabledDates:M,lang:a}),(0,l.jsxs)("div",{className:"flex justify-between text-lg md:hidden",children:[(0,l.jsxs)("div",{className:"flex justify-center items-center gap-1 p-3 pl-4 rounded-full bg-lightGray/40 backdrop-blur-[.625rem]",onClick:()=>{w(void 0),E(!1),z(null)},children:[F.reset,(0,l.jsx)("span",{className:"size-6 bg-[url('../../public/assets/images/restart.svg')] bg-no-repeat bg-center"})]}),(0,l.jsxs)("div",{className:"flex justify-center items-center gap-1 p-3 pl-4 rounded-full bg-purple text-white",onClick:()=>{P(!1)},children:[F.applyFilter,(0,l.jsx)("span",{className:"size-6 bg-[url('../../public/assets/images/check.svg')] bg-no-repeat bg-center"})]})]})]})})})]})}a(1747)},9413:function(e,t,a){"use strict";a.d(t,{e:function(){return c}});var l=JSON.parse('{"AF":"detour-2024","_d":""}'),s=a(8474),r=a(8274);let n=a(357).env.NEXT_PUBLIC_PRISMIC_ENVIRONMENT||l.AF,i=[{type:"page",path:"/:lang",uid:"home"},{type:"page",path:"/:lang/:uid"},{type:"page",path:"/:lang/events",uid:"events"},{type:"events_post",path:"/:lang/events/:uid"}],c=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=s.eI(l._d||n,{routes:i,fetchOptions:{next:{tags:["prismic"]},cache:"force-cache"},...e});return r.L({client:t}),t}}},function(e){e.O(0,[787,933,397,390,490,971,23,744],function(){return e(e.s=8425)}),_N_E=e.O()}]);